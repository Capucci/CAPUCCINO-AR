<!DOCTYPE html>
<html>
<head>
   <script>
const VERSION = "1.9.3"; 
</script>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>

<style>
  body { margin: 0; overflow: hidden; background: transparent; }
  .a-enter-vr { bottom: 20px !important; right: 20px !important; left: auto !important; top: auto !important; }
</style>
</head>

<body>

<a-scene
  mindar-image="imageTargetSrc: Target01.mind;"
  vr-mode-ui="enabled: false"
  device-orientation-permission-ui="enabled: false"
  background="transparent"
  embedded>

  <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

  <a-entity mindar-image-target="targetIndex: 0" id="target-principal">

    <!-- VÍDEO CORRIGIDO: rotation="0 0 0" = orientação normal -->
    <a-video
      id="video-principal"
      src="#meuVideo"
      position="0 0 0.1"
      rotation="0 0 0"
      width="1.5"
      height="0.85">
    </a-video>

  </a-entity>

  <!-- VÍDEO COM ÁUDIO -->
  <video id="meuVideo" preload="auto" loop="false" crossorigin="anonymous" style="display: none;" playsinline>
    <source src="Video Antecipe Portugues 1.mp4" type="video/mp4">
  </video>

  <script>
// Inicialização simples e direta
document.addEventListener("DOMContentLoaded", function() {
  
  const target = document.querySelector('#target-principal');
  const video = document.getElementById('meuVideo');
  
  // Configurações básicas
  video.volume = 1.0;
  video.muted = false;
  
  let primeiraVez = true;
  let tempoPausado = 0;

  // Quando encontrar o target
  target.addEventListener("targetFound", function() {
    console.log("TARGET ENCONTRADO");
    
    // Se for a primeira vez, tenta tocar
    if (primeiraVez) {
      primeiraVez = false;
      
      // Estratégia: tenta tocar e se falhar, aguarda clique
      const playPromise = video.play();
      
      if (playPromise !== undefined) {
        playPromise.catch(() => {
          // Se falhou, espera um clique na tela
          document.body.addEventListener('click', function() {
            video.play();
          }, { once: true });
        });
      }
    } else {
      // Já não é primeira vez, só retoma de onde parou
      if (tempoPausado > 0) video.currentTime = tempoPausado;
      video.play();
    }
  });

  // Quando perder o target
  target.addEventListener("targetLost", function() {
    console.log("TARGET PERDIDO");
    tempoPausado = video.currentTime;
    video.pause();
  });

  // Quando o vídeo acabar
  video.addEventListener('ended', function() {
    console.log("VÍDEO TERMINOU");
    tempoPausado = 0;
  });

  // Carrega o vídeo
  video.load();

});
</script>

</body>
</html>
