<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR Multi Targets</title>
    
    <!-- Bibliotecas -->
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
    
    <style>
        body { margin: 0; overflow: hidden; }
        
        /* BotÃ£o de Ã¡udio */
        .audio-btn {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            z-index: 9999;
            cursor: pointer;
            border: 2px solid white;
            background: rgba(0,0,0,0.7);
            color: white;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .playing { background: rgba(0,128,0,0.8); }
        .paused { background: rgba(255,0,0,0.8); }
        
        /* Loading */
        #loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            background: rgba(0,0,0,0.7);
            padding: 20px;
            border-radius: 10px;
            z-index: 10000;
        }
    </style>
</head>
<body>

    <!-- Loading -->
    <div id="loading">ðŸ“± Inicializando AR...</div>

    <!-- BotÃ£o de Ã¡udio -->
    <button class="audio-btn paused" id="audioBtn">ðŸ”‡</button>

    <a-scene
        mindar-image="imageTargetSrc: Target01.mind; autoStart: true;"
        vr-mode-ui="enabled: false"
        device-orientation-permission-ui="enabled: false"
        embedded
        color-space="sRGB"
        renderer="colorManagement: true;"
        background="color: black">

        <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

        <!-- TARGET 0 -->
        <a-entity mindar-image-target="targetIndex: 0">
            <!-- Modelo 3D -->
            <a-entity
                gltf-model="BonnyCaminha.glb"
                animation-mixer
                position="0 0 0.3"
                rotation="-90 0 0"
                scale="0.7 0.7 0.7">
            </a-entity>
            
            <!-- Ãudio -->
            <a-entity
                id="audio0"
                sound="src: Moo.mp3; autoplay: false; loop: true; positional: false;">
            </a-entity>
        </a-entity>

        <!-- TARGET 1 -->
        <a-entity mindar-image-target="targetIndex: 1">
            <a-entity
                gltf-model="Cena 01Teste.glb"
                animation-mixer
                position="0 0 0.3"
                rotation="-90 0 0"
                scale="0.7 0.7 0.7">
            </a-entity>
            
            <a-entity
                id="audio1"
                sound="src: Passaros.mp3; autoplay: false; loop: true; positional: false;">
            </a-entity>
        </a-entity>

        <!-- TARGET 2 -->
        <a-entity mindar-image-target="targetIndex: 2">
            <a-entity
                gltf-model="MascoteDanca.glb"
                animation-mixer
                position="0 0 0.3"
                rotation="-90 0 0"
                scale="0.7 0.7 0.7">
            </a-entity>
            
            <a-entity
                id="audio2"
                sound="src: Chuva02.mp3; autoplay: false; loop: true; positional: false;">
            </a-entity>
        </a-entity>

        <!-- TARGET 3 (vazio) -->
        <a-entity mindar-image-target="targetIndex: 3"></a-entity>

        <!-- TARGET 4 (vazio) -->
        <a-entity mindar-image-target="targetIndex: 4"></a-entity>

        <!-- TARGET 5 (vazio) -->
        <a-entity mindar-image-target="targetIndex: 5"></a-entity>

    </a-scene>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            
            const loading = document.getElementById('loading');
            const audioBtn = document.getElementById('audioBtn');
            
            // Lista de Ã¡udios
            const audios = ['#audio0', '#audio1', '#audio2'];
            let currentAudio = null;
            
            // Quando a cena carregar
            const scene = document.querySelector('a-scene');
            
            scene.addEventListener('loaded', function() {
                loading.innerHTML = 'âœ… Pronto! Aponte para os targets...';
                setTimeout(() => loading.style.display = 'none', 2000);
            });

            // Detectar targets
            const targets = document.querySelectorAll('[mindar-image-target]');
            
            targets.forEach((target, index) => {
                target.addEventListener('targetFound', () => {
                    console.log(`ðŸŽ¯ Target ${index} encontrado!`);
                    loading.style.display = 'block';
                    loading.innerHTML = `âœ… Target ${index} encontrado!`;
                    setTimeout(() => loading.style.display = 'none', 1000);
                    
                    // Parar Ã¡udio anterior
                    if (currentAudio) {
                        currentAudio.components.sound.stopSound();
                    }
                    
                    // Tocar novo Ã¡udio
                    if (index < audios.length) {
                        const audio = document.querySelector(audios[index]);
                        if (audio) {
                            audio.components.sound.playSound();
                            currentAudio = audio;
                            audioBtn.classList.add('playing');
                            audioBtn.classList.remove('paused');
                            audioBtn.innerHTML = 'ðŸ”Š';
                        }
                    }
                });

                target.addEventListener('targetLost', () => {
                    console.log(`ðŸš« Target ${index} perdido!`);
                    
                    if (currentAudio) {
                        currentAudio.components.sound.stopSound();
                        currentAudio = null;
                        audioBtn.classList.remove('playing');
                        audioBtn.classList.add('paused');
                        audioBtn.innerHTML = 'ðŸ”‡';
                    }
                });
            });

            // BotÃ£o de Ã¡udio manual
            audioBtn.addEventListener('click', function() {
                if (currentAudio) {
                    currentAudio.components.sound.stopSound();
                    currentAudio = null;
                    audioBtn.classList.remove('playing');
                    audioBtn.classList.add('paused');
                    audioBtn.innerHTML = 'ðŸ”‡';
                }
            });

            // Desbloquear Ã¡udio no primeiro clique
            document.body.addEventListener('click', function unlock() {
                document.querySelectorAll('[sound]').forEach(el => {
                    el.components.sound.playSound();
                    el.components.sound.stopSound();
                });
                document.body.removeEventListener('click', unlock);
            });

            console.log('ðŸš€ AR iniciado!');
        });
    </script>

</body>
</html>
