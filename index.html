<!DOCTYPE html>
<html>
<head>
   <script>
const VERSION = "7.1.0"; 
</script>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>

<style>
body { margin:0; overflow:hidden; }
.audio-control-btn {
  position: fixed;
  bottom: 20px;
  left: 20px;
  width: 50px;
  height: 50px;
  border-radius: 50%;
  z-index: 9999;
  cursor: pointer;
  border: 2px solid white;
  box-shadow: 0 4px 8px rgba(0,0,0,0.3);
  font-size: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: rgba(0, 0, 0, 0.7);
}
.audio-control-btn.playing { background-color: rgba(0, 128, 0, 0.8); }
.audio-control-btn.paused { background-color: rgba(255, 0, 0, 0.8); }
.audio-control-btn:hover { transform: scale(1.1); }
.a-enter-vr {
  position: fixed;
  bottom: 20px !important;
  right: 20px !important;
  left: auto !important;
  top: auto !important;
  transform: none !important;
}
/* Debug - mostra status */
#debug-status {
  position: fixed;
  top: 20px;
  right: 20px;
  background: rgba(0,0,0,0.7);
  color: #00ff88;
  padding: 10px;
  border-radius: 5px;
  z-index: 10000;
  font-family: monospace;
  font-size: 12px;
}
</style>
</head>

<body>

<!-- Debug status -->
<div id="debug-status">ðŸ“¡ Inicializando...</div>

<a-scene
  mindar-image="imageTargetSrc: Target01.mind; autoStart: true;" <!-- Use UM arquivo .mind -->
  vr-mode-ui="enabled: false"
  device-orientation-permission-ui="enabled: false"
  embedded
  arjs="sourceType: webcam; debugUIEnabled: false;">

  <a-camera position="0 0 0" look-controls="enabled: false">
    <a-entity cursor="fuse: false; rayOrigin: mouse"
              raycaster="objects: .clickable"
              geometry="primitive: ring; radiusInner: 0.001; radiusOuter: 0.001"
              material="transparent: true">
    </a-entity>
  </a-camera>

  <!-- ========================================= -->
  <!-- BLOCO DE CENA 0 - TARGET 0                -->
  <!-- ========================================= -->
  <a-entity mindar-image-target="targetIndex: 0" id="cena-00" class="cena">
    
    <!-- MODELO 3D -->
    <a-entity
      id="modelo-cena00"
      gltf-model="BonnyCaminha.glbl"
      animation-mixer="clip: ; loop: repeat;"
      position="0 0 0.3"
      rotation="-90 0 0"
      scale="0.7 0.7 0.7"
      visible="true">  <!-- ComeÃ§a visÃ­vel para teste -->
    </a-entity>
    
    <!-- ÃUDIO -->
    <audio id="audio-cena00" preload="auto" loop>
      <source src="Moo.mp3" type="audio/mpeg">
    </audio>

  </a-entity>

  <!-- ========================================= -->
  <!-- BLOCO DE CENA 1 - TARGET 1                -->
  <!-- ========================================= -->
  <a-entity mindar-image-target="targetIndex: 1" id="cena-01" class="cena">
    
    <a-entity
      id="modelo-cena01"
      gltf-model="Cena 01Teste.glbl"
      animation-mixer="clip: ; loop: repeat;"
      position="0 0 0.3"
      rotation="-90 0 0"
      scale="0.7 0.7 0.7"
      visible="true">
    </a-entity>
    
    <audio id="audio-cena01" preload="auto" loop>
      <source src="Passaros.mp3" type="audio/mpeg">
    </audio>

  </a-entity>

  <!-- ========================================= -->
  <!-- BLOCO DE CENA 2 - TARGET 2                -->
  <!-- ========================================= -->
  <a-entity mindar-image-target="targetIndex: 2" id="cena-02" class="cena">
    
    <a-entity
      id="modelo-cena02"
      gltf-model="MascoteDanca.glbl"
      animation-mixer="clip: ; loop: repeat;"
      position="0 0 0.3"
      rotation="-90 0 0"
      scale="0.7 0.7 0.7"
      visible="true">
    </a-entity>
    
    <audio id="audio-cena02" preload="auto" loop>
      <source src="Chuva02.mp3" type="audio/mpeg">
    </audio>

  </a-entity>

</a-scene>

<!-- BotÃ£o de Ã¡udio -->
<button class="audio-control-btn paused" id="audioBtn">ðŸ”‡</button>

<script>
document.addEventListener("DOMContentLoaded", function() {
  
  const debug = document.getElementById('debug-status');
  const audioBtn = document.getElementById('audioBtn');
  
  // ============================================
  // TESTE 1: Verificar se os elementos existem
  // ============================================
  debug.innerHTML = "ðŸ” Verificando elementos...";
  
  const scene = document.querySelector('a-scene');
  if (scene) {
    debug.innerHTML = "âœ… Scene carregada";
  } else {
    debug.innerHTML = "âŒ Scene nÃ£o encontrada";
    return;
  }
  
  // ============================================
  // TESTE 2: Verificar MindAR
  // ============================================
  scene.addEventListener('mindar-image-ready', () => {
    debug.innerHTML = "ðŸŽ¯ MindAR pronto - Aguardando targets...";
  });
  
  scene.addEventListener('mindar-image-target-found', (e) => {
    debug.innerHTML = `âœ… Target encontrado: ${e.detail.targetIndex}`;
    console.log('Target encontrado:', e.detail);
  });
  
  scene.addEventListener('mindar-image-target-lost', (e) => {
    debug.innerHTML = `âŒ Target perdido: ${e.detail.targetIndex}`;
  });

  // ============================================
  // TESTE 3: Verificar cada target individualmente
  // ============================================
  const cenas = document.querySelectorAll('.cena');
  cenas.forEach((cena, index) => {
    cena.addEventListener('targetFound', () => {
      debug.innerHTML = `ðŸŽ¯ CENA ${index} ATIVADA!`;
      console.log(`Cena ${index} ativada`);
      
      // Tocar Ã¡udio da cena
      const audio = document.getElementById(`audio-cena0${index}`);
      if (audio) {
        audio.play().catch(e => console.log('Ãudio bloqueado:', e));
      }
    });
    
    cena.addEventListener('targetLost', () => {
      debug.innerHTML = `ðŸ‘‹ CENA ${index} perdida`;
      console.log(`Cena ${index} perdida`);
      
      const audio = document.getElementById(`audio-cena0${index}`);
      if (audio) {
        audio.pause();
      }
    });
  });

  // ============================================
  // BotÃ£o de Ã¡udio
  // ============================================
  audioBtn.addEventListener('click', () => {
    // Desbloquear Ã¡udio
    document.querySelectorAll('audio').forEach(audio => {
      audio.play().then(() => {
        audio.pause();
        audio.currentTime = 0;
      }).catch(e => console.log('Erro ao desbloquear:', e));
    });
    
    audioBtn.classList.toggle('playing');
    audioBtn.classList.toggle('paused');
    audioBtn.innerHTML = audioBtn.classList.contains('playing') ? 'ðŸ”Š' : 'ðŸ”‡';
  });

  console.log('ðŸš€ Sistema iniciado');
});
</script>

</body>
</html>
